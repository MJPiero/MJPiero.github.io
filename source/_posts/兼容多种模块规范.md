---
title: 兼容多种模块规范
date: 2016-12-08 12:13:38
tags: [JavaScript]
categories: [JavaScript]
---

我们通常需要将类库代码包装在一个闭包内，为了能兼容Node、AMD、CMD以及一些常见的浏览器环境中，我们可以使用如下的方法去包装。
```
;(function (name, definition) {

// 检测上下文环境是否为AMD或CMD
if (typeof define === "function" && ( define.amd || define.cmd ) ) {

	define(definition);

// 检测上下文环境是否为Node
} else if ( typeof module !== 'undefined' && module.exports ) {

	module.exports = definition();

} else {
	// 将模块的执行结果在window变量中，在浏览器中this指向window对象
	this[name] = definition();
}
})('hello', function () {
	var hello = function () {};
	return hello;
});
```